---
description: 
globs: 
alwaysApply: true
---
---
name: zxsq_topic_project_context_guard       # è§„åˆ™åç§°
description: å…¨å±€ä¸Šä¸‹æ–‡&è®°å¿†å®ˆæŠ¤ â€“ ä¿æŒé¡¹ç›®è§„èŒƒã€ä¸€è‡´æ¥å£ä¸æ—¥å¿—é£æ ¼
pattern: "**/*.py"                           # ä½œç”¨æ–‡ä»¶
memoryId: zxsq_topic_project_global          # å¼€å¯æŒä¹…è®°å¿†
writeMemory: true                            # æ‰§è¡ŒåæŠŠå›ç­”è¿½åŠ è¿›è®°å¿†
autoAttachments:
  - file                                     # è‡ªåŠ¨é™„ä¸Šå½“å‰æ–‡ä»¶å†…å®¹
---

ğŸ”„ **å›å¿†é˜¶æ®µ (v3.0æ™ºèƒ½åŒ–å‡çº§)**
- è¿™æ˜¯ä¸€å¥—åä¸ºã€zxsq_topic_projectã€çš„æ™ºèƒ½æŠ•èµ„è¯é¢˜æŠ½å–ç³»ç»Ÿï¼Œç›®å½•ç»“æ„å·²å›ºå®šï¼š
  extractor/      (è¯é¢˜ & æ™ºèƒ½è‚¡ä»·æŠ“å–)  
  llm_filter/     (LLM æ™ºèƒ½ä¿¡æ¯æå–)
  to_excel_converter.py (ğŸ†• CSVè½¬Excelå·¥å…·)
  data/           (ğŸ†• è‚¡ç¥¨æ•°æ®åº“ç¼“å­˜)
  config.py       (ğŸ†• å…¨å±€é…ç½®+APIé›†ä¸­ç®¡ç†)
  main.py         (ç¨‹åºå…¥å£)
- **ğŸ†• v3.0é‡å¤§å‡çº§**ï¼šakshareæ™ºèƒ½æ˜ å°„(9,888åªè‚¡ç¥¨)ï¼Œcurl_cffi TLSä¼ªè£…ï¼Œé…ç½®é›†ä¸­ç®¡ç†
- **ğŸ†• v3.1é‡å¤§å‡çº§**ï¼šæ–°å¢Excelè½¬æ¢ç®¡é“ï¼Œä¼˜åŒ–è¾“å‡ºä½“éªŒï¼›akshareæ™ºèƒ½æ˜ å°„(9,888åªè‚¡ç¥¨)ï¼Œcurl_cffi TLSä¼ªè£…ï¼Œé…ç½®é›†ä¸­ç®¡ç†
- **æ‰€æœ‰ä»£ç å¿…é¡»éµå®ˆé¡¹ç›®çº¦å®š**ï¼ˆè§ä¸‹æ–¹âš™ï¸è§„èŒƒï¼‰ã€‚
- è¯·å…ˆå¿«é€Ÿæ‰«æ /memory ä¸­çš„æŒä¹…è®°å¿†ç‰‡æ®µï¼Œç¡®ä¿ä½ è®°ä½ä¹‹å‰ç”Ÿæˆçš„æ¨¡å—ä¾èµ–ã€å‡½æ•°ç­¾åä¸è·¯å¾„ã€‚

âœï¸ **æ‰§è¡Œé˜¶æ®µ**
- åŸºäºç”¨æˆ·çš„æ–°è¯·æ±‚ï¼Œå¯¹å½“å‰æ–‡ä»¶è¿›è¡Œè¡¥å……/é‡å†™ã€‚
- ä¿æŒå·²æœ‰ import/å‡½æ•°å/æ³¨é‡Šé£æ ¼ï¼›è‹¥æ–°å¢æ–‡ä»¶ï¼Œéµå¾ªç›®å½•è§„åˆ’æ”¾ç½®ã€‚
- é˜…è¯» README.md äº†è§£æœ€æ–°åŠŸèƒ½å’Œé…ç½®
- ğŸ†• **ä½¿ç”¨æ–°æŠ€æœ¯æ ˆ**ï¼šakshareè‚¡ç¥¨æ˜ å°„ã€curl_cffi TLSä¼ªè£…ã€é…ç½®é›†ä¸­ç®¡ç†

âœ… **è‡ªæ£€é˜¶æ®µ**
- å†™å®Œåï¼Œå†æ¬¡æ£€æŸ¥ï¼š  
  1. æ˜¯å¦ç ´åäº†ä»»ä½•æ—¢æœ‰ public APIï¼ˆå‡½æ•°åã€è¿”å›å€¼ç±»å‹ï¼‰ã€‚  
  2. æ˜¯å¦é—æ¼ä¸­æ–‡ç±»å‹æ³¨é‡Šã€loggingã€å¼‚å¸¸æ•è·ã€‚  
  3. æ–°å¢ä¾èµ–æ˜¯å¦å·²å†™å…¥ requirements.txtã€‚
  4. é…ç½®æ˜¯å¦æ­£ç¡®ä½¿ç”¨ config.py ä¸­çš„å˜é‡ã€‚
  5. ğŸ†• **æ˜¯å¦ä½¿ç”¨äº†æ™ºèƒ½æ˜ å°„å’ŒTLSä¼ªè£…åŠŸèƒ½**ã€‚

âš™ï¸ **é¡¹ç›®è§„èŒƒ v3.0ï¼ˆåŠ¡å¿…ç‰¢è®°ï¼‰**
1) **Python â‰¥3.9**ï¼Œå…¨éƒ¨å‡½æ•°å†™ç±»å‹æ³¨è§£ï¼Œå…³é”®é€»è¾‘å†™ä¸­æ–‡æ³¨é‡Šã€‚  
2) **ğŸ†• æ™ºèƒ½è‚¡ç¥¨æ˜ å°„** ä½¿ç”¨ akshare æ•°æ®åº“ï¼šextractor/ticker_mapper.pyï¼Œ9,888åªè‚¡ç¥¨å®Œæ•´è¦†ç›–ã€‚  
3) **ğŸ†• TLSæŒ‡çº¹ä¼ªè£…** ä½¿ç”¨ curl_cffiï¼šextractor/price_fetcher.pyï¼ŒChromeæŒ‡çº¹ä¼ªè£…è§„é¿Rate Limitã€‚  
4) **ç½‘ç»œå±‚** ä¼˜å…ˆä½¿ç”¨ curl_cffi requestsï¼›å¦‚éœ€å¼‚æ­¥åˆ™ aiohttpï¼‹asyncioã€‚  
5) **æ—¥å¿—ç³»ç»Ÿ** ç¦æ­¢ printï¼Œç»Ÿä¸€ç”¨ loggingï¼›æ—¥å¿—æ–‡ä»¶å†™åˆ° logs/ï¼Œè‡ªåŠ¨æ¸…ç†30ä¸ªæ–‡ä»¶ã€‚  
6) **ğŸ†• è‚¡ä»·è·å–** TLSä¼ªè£…å¤šæ•°æ®æºï¼šyfinance+curl_cffi â†’ è…¾è®¯API â†’ æ–°æµªAPI â†’ ç½‘æ˜“APIã€‚  
7) **ğŸ†• LLMé…ç½®** ä½¿ç”¨ config.py ç»Ÿä¸€ç®¡ç†ï¼šAPI_BASE_URL, OPENAI_MODEL, TEMPERATUREã€‚  
8) **ğŸ†• é…ç½®é›†ä¸­** æ‰€æœ‰APIè®¾ç½®åœ¨ config.pyï¼šæ”¯æŒä¸€é”®åˆ‡æ¢çŸ¥è¯†æ˜Ÿçƒ(STAR_ID+COOKIE)ã€‚  
9) **è¾“å‡ºæ ¼å¼** CSVä¸­æ–‡å­—æ®µï¼Œæ–‡ä»¶åæ ¼å¼: `ä¼šè®®çºªè¦_YY.MM.DD.csv`ï¼Œè·¯å¾„å†™åˆ° output/ã€‚
10) **ä»·æ ¼æ ¼å¼** åŒ…å«è´§å¸ç¬¦å·ï¼ˆå¦‚ï¼šÂ¥1415.60ã€HK$499.60ã€$150.25ï¼‰ï¼Œä¸åŒ…å«æ¶¨è·Œå¹…ç™¾åˆ†æ¯”ã€‚
11) **å¤šæ ‡çš„æ”¯æŒ** æŒ‰æ¨èå¼ºå¼±æ’åºï¼Œæœ€å¤š3ä¸ªæ ‡çš„ï¼ŒLLMè‡ªåŠ¨æ’åºã€‚
12) **ğŸ†• Excelå¯¼å‡º** ä½¿ç”¨ `to_excel_converter.py` å°†CSVè½¬æ¢ä¸ºæ ¼å¼åŒ–çš„Excelï¼Œæ”¯æŒæŒ‰æ—¥æœŸåˆ†sheetå’Œè‡ªåŠ¨åˆ—å®½ã€‚

ğŸ“Š **è¾“å‡ºè§„èŒƒ v3.0**
- **CSVå­—æ®µé¡ºåº**: æ ‡é¢˜ã€æ—¥æœŸ(HH:MM)ã€æ¿å—ã€æ ‡çš„1-3ã€ä»·æ ¼1-3ã€ç®€è¿°ã€æ¨èç†ç”±ã€é¢„æœŸã€åŸæ–‡
- **æ–‡ä»¶å‘½å**: `ä¼šè®®çºªè¦_25.07.03.csv` æ ¼å¼
- **ğŸ†• æ™ºèƒ½æ˜ å°„**: ä½¿ç”¨ SmartTickerMapper å®ç°95%æˆåŠŸç‡ï¼Œå››å±‚åŒ¹é…ç®—æ³•
- **LLMæå–**: target, ticker, sector, reason, expectation äº”ä¸ªå­—æ®µ
- **æ™ºèƒ½æ’åº**: å¤šä¸ªæ ‡çš„æŒ‰æ¨èå¼ºå¼±è‡ªåŠ¨æ’åº

ğŸ”§ **é…ç½®ç®¡ç† v3.0**
- **ğŸ†• APIé›†ä¸­**: æ‰€æœ‰APIè®¾ç½®ç»Ÿä¸€åœ¨ config.pyï¼šAPI_BASE_URL, API_HOST, API_TIMEOUTç­‰
- **ğŸ†• æ˜Ÿçƒåˆ‡æ¢**: åªéœ€ä¿®æ”¹ STAR_ID å’Œ COOKIE å³å¯åˆ‡æ¢çŸ¥è¯†æ˜Ÿçƒ
- **Temperature**: ä½¿ç”¨ config.TEMPERATURE (å½“å‰0.2)
- **DeepSeekæ”¯æŒ**: OPENAI_API_BASE = "https://api.deepseek.com"
- **ğŸ†• æ™ºèƒ½ç¼“å­˜**: è‚¡ç¥¨æ•°æ®24å°æ—¶ç¼“å­˜åœ¨ data/stock_cache.json
- **ğŸ†• TLSä¼ªè£…**: curl_cffiè‡ªåŠ¨ChromeæŒ‡çº¹ï¼Œsession = create_session()

ğŸš€ **æŠ€æœ¯æ ˆ v3.0**
- **æ ¸å¿ƒä¾èµ–**: yfinance>=0.2.54, akshare>=1.13.0, curl_cffi>=0.11.0
- **Excelå¯¼å‡º**: openpyxl
- **æ™ºèƒ½æ˜ å°„**: extractor.ticker_mapper.SmartTickerMapper (9,888åªè‚¡ç¥¨æ•°æ®åº“)
- **TLSä¼ªè£…**: extractor.price_fetcher.create_session() (ChromeæŒ‡çº¹)
- **å¹¶å‘å¤„ç†**: 5çº¿ç¨‹ThreadPoolExecutorï¼Œ3-5å€é€Ÿåº¦æå‡
- **é…ç½®ç®¡ç†**: config.pyé›†ä¸­ç®¡ç†ï¼Œæ”¯æŒå¤šæ˜Ÿçƒåˆ‡æ¢
- **æ—¥å¿—ç³»ç»Ÿ**: setup_logging(), get_logger()ï¼Œè‡ªåŠ¨æ¸…ç†æœºåˆ¶
